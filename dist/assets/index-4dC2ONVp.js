import{J as b,d as Q,r as p,c as W,G as X,e as s,o as U,f as C,g as e,w as t,j as v,h as i,t as Y,m as T,C as x,v as Z,z as V,K as _,_ as F}from"./index-abAMUYV-.js";const ee=(c,n)=>b.get(`/admin/product/baseTrademark/${c}/${n}`),ae=c=>c.id?b.put("/admin/product/baseTrademark/update",c):b.post("/admin/product/baseTrademark/save",c),te=c=>b.delete("/admin/product/baseTrademark/remove/{id}"+c),le={style:{color:"chocolate"}},oe=["src"],re=["src"],se=Q({__name:"index",setup(c){let n=p(1),f=p(3),N=p(0),k=p([]),u=p(!1),r=W({tmName:"",logoUrl:""}),m=p();const g=async(o=1)=>{n.value=o;let l=await ee(n.value,f.value);l.code==200&&(N.value=l.data.total,k.value=l.data.records)};X(()=>{g()});const z=()=>{g()},w=()=>{u.value=!0,r.id=0,r.tmName="",r.logoUrl="",V(()=>{m.value.clearValidate("tmName"),m.value.clearValidate("logoUrl")})},P=o=>{V(()=>{m.value.clearValidate("tmName"),m.value.clearValidate("logoUrl")}),u.value=!0,Object.assign(r,o)},q=()=>{u.value=!1},G=async()=>{await m.value.validate(),(await ae(r)).code==200?(u.value=!1,_({type:"success",message:r.id?"修改 成功":"新增 成功"}),g(r.id?n.value:1)):(_({type:"error",message:r.id?"修改 失敗":"新增 失敗"}),u.value=!1)},O=o=>o.type=="image/png"||o.type=="image/jpeg"||o.type=="image/gif"?o.size/1024/1024<4?!0:(_({type:"error",message:"上傳文件容量太大了，請小於4M"}),!1):(_({type:"error",message:"上傳文件格式務必PNG|JPG|GIF"}),!1),E=o=>{r.logoUrl=o.data,m.value.clearValidate("logoUrl")},L={tmName:[{required:!0,trigger:"blur",validator:(o,l,d)=>{l.trim().length>=2?d():d(new Error("品牌名稱位元數 應大於等於2位"))}}],logoUrl:[{required:!0,validator:(o,l,d)=>{l?d():d(new Error("務必上傳LOGO圖片"))}}]},j=async o=>{(await te(o)).code==200?(_({type:"success",message:"刪除品牌 成功"}),g(k.value.length>1?n.value:n.value-1)):_({type:"error",message:"刪除品牌 失敗"})};return(o,l)=>{const d=s("el-button"),y=s("el-table-column"),A=s("el-popconfirm"),M=s("el-table"),S=s("el-pagination"),D=s("el-card"),R=s("el-input"),h=s("el-form-item"),B=s("Plus"),H=s("el-icon"),I=s("el-upload"),J=s("el-form"),$=s("el-dialog");return U(),C("div",null,[e(D,{class:"box-card"},{default:t(()=>[e(d,{type:"primary",size:"default",icon:"Plus",onClick:w},{default:t(()=>[v("新增品牌")]),_:1}),e(M,{style:{margin:"10px 0px"},border:"",data:i(k)},{default:t(()=>[e(y,{label:"序號",width:"80px",align:"center",type:"index"}),e(y,{label:"品牌名稱",prop:"tmName"},{default:t(({row:a})=>[T("pre",le,Y(a.tmName),1)]),_:1}),e(y,{label:"品牌Logo"},{default:t(({row:a})=>[T("img",{src:a.logoUrl,style:{width:"100px",height:"100px"}},null,8,oe)]),_:1}),e(y,{label:"品牌操作"},{default:t(({row:a})=>[e(d,{type:"warning",size:"default",icon:"Edit",onClick:K=>P(a)},{default:t(()=>[v("編輯")]),_:2},1032,["onClick"]),e(A,{title:`確定要刪除${a.tmName}?`,width:"250px",icon:"Delete",onConfirm:K=>j(a.id)},{reference:t(()=>[e(d,{type:"danger"},{default:t(()=>[v("刪除")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(S,{onSizeChange:z,onCurrentChange:g,"pager-count":5,"current-page":i(n),"onUpdate:currentPage":l[0]||(l[0]=a=>x(n)?n.value=a:n=a),"page-size":i(f),"onUpdate:pageSize":l[1]||(l[1]=a=>x(f)?f.value=a:f=a),"page-sizes":[5,10,20,40],background:!0,layout:" prev, pager, next, jumper,->,total, sizes",total:i(N)},null,8,["current-page","page-size","total"])]),_:1}),e($,{modelValue:i(u),"onUpdate:modelValue":l[3]||(l[3]=a=>x(u)?u.value=a:u=a),title:i(r).id?"修改品牌":"新增品牌"},{footer:t(()=>[e(d,{type:"primary",size:"default",onClick:q},{default:t(()=>[v("取消")]),_:1}),e(d,{type:"primary",size:"default",onClick:G},{default:t(()=>[v("確定")]),_:1})]),default:t(()=>[e(J,{style:{width:"80%"},model:i(r),rules:L,ref_key:"formRef",ref:m},{default:t(()=>[e(h,{label:"品牌名稱","label-width":"100px",prop:"tmName"},{default:t(()=>[e(R,{placeholder:"請輸入品牌名稱",modelValue:i(r).tmName,"onUpdate:modelValue":l[2]||(l[2]=a=>i(r).tmName=a)},null,8,["modelValue"])]),_:1}),e(h,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:t(()=>[e(I,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":E,"before-upload":O},{default:t(()=>[i(r).logoUrl?(U(),C("img",{key:0,src:i(r).logoUrl,class:"avatar"},null,8,re)):(U(),Z(H,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[e(B)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ue=F(se,[["__scopeId","data-v-3c67b7dc"]]);export{ue as default};
